{% extends 'base_generic.html' %}

<script>
  {% block jquery %}
  var endpoint = '/weightlog/api/chart/data/'
  var defaultData = []
  var labels = []
  $.ajax({
      method: "GET",
      url: endpoint,
      success: function(data){
          labels = data.date
          defaultData = data.weight
          console.log(data.weight)
          console.log(data.date)
          setChart()
      },
      error: function(error_data){
          console.log("error")
          console.log(error_data)
      }
  })

  function setChart(){
      const ctx = document.getElementById("myChart").getContext("2d");
      const myChart = new Chart(ctx, {
        type: "line",
        data: {
          labels: labels,
          datasets: [
            {
              label: "Weight Progression",
              data: defaultData,
              backgroundColor: [
                "rgba(255, 99, 132, 0.2)",
                "rgba(54, 162, 235, 0.2)",
                "rgba(255, 206, 86, 0.2)",
                "rgba(75, 192, 192, 0.2)",
                "rgba(153, 102, 255, 0.2)",
                "rgba(255, 159, 64, 0.2)",
              ],
              borderColor: [
                "rgba(255, 99, 132, 1)",
                "rgba(54, 162, 235, 1)",
                "rgba(255, 206, 86, 1)",
                "rgba(75, 192, 192, 1)",
                "rgba(153, 102, 255, 1)",
                "rgba(255, 159, 64, 1)",
              ],
              borderWidth: 1,
            },
          ],
        },
        options: {
          scales: {
            y: {
              beginAtZero: true,
            },
          },
        },
      });
  }

  {% endblock %}
</script>

{% block content %}
<div class='container-sm'>
<div class="row">
  <div class="col-sm-12" url-endpoint='{% url "api-data" %}'>
    <p>{{ my_user.first_name }} {{ my_user.last_name }}</p>
    <canvas id="myChart" width="400" height="400"></canvas>
  </div>
</div>
</div>

{% endblock content %}
